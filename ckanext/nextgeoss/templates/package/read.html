{% extends "package/read_base.html" %}

{% set pkg = c.pkg_dict %}
{% set org_title = pkg.organization.get('title') or pkg.organization['name'] %}
{% set org_link = h.url_for(controller='organization', action='read', id=pkg.owner_org) %}
{% set col_title = pkg.title %}
{% set col_name = h.get_extras_value(pkg.extras, 'collection_name') %}
{% set col_link = h.get_collection_url(col_name) %}
{% set thumbnail_path = h.ng_get_dataset_thumbnail_path(pkg) %}

{% block pre_primary %}
  <div class="container single-column">
    {% snippet "package/snippets/nav_tabs.html", pkg=pkg %}
    {% block package_description %}
      <div class="dataset-detail">
        <div class="dataset-detail-org-logo">
            <div class="image">
              <a href="{{ org_link }}">
                <img src="{{ thumbnail_path }}" height= "210" width="210" alt="{{ thumbnail_path }}" />
              </a>
            </div>
          </div>
          {% if pkg.private %}
            <span class="dataset-private label label-inverse pull-right">
              <i class="fa fa-lock"></i>
              {{ _('Private') }}
            </span>
          {% endif %}
          <h1 class="dataset-detail-title">
            {% block page_heading %}
              {{ pkg.name }}
              {% if pkg.state.startswith('draft') %}
                [{{ _('Draft') }}]
              {% endif %}
              {% if pkg.state == 'deleted' %}
                [{{ _('Deleted') }}]
              {% endif %}
            {% endblock %}
          </h1>
          <h5 class="dataset-detail-title">{{ _('Published by ') }} <a href="{{ org_link }}">{{ org_title }}</a></h5>
          {% if col_name is not none %}
            <h5 class="dataset-detail-title">{{ _('Part of collection ') }} <a href="{{ col_link }}">{{ col_title }}</a></h5>
          {% endif %}
        {% endblock %}

        {% block package_notes %}
            <div class="notes embedded-content dataset-notes">
          {% if pkg.notes %}
            {{ h.render_markdown(h.get_translated(pkg, 'notes')) }}
          {% else %}
            <p class="empty">{{ _('There is no description for this dataset') }}</p>
          {% endif %}
          </div>
        {% endblock %}
      </div>

    {% endblock %}

    {% set dataset_extent = h.get_pkg_dict_extra(c.pkg_dict, 'spatial', '') %}

    {% if dataset_extent %}
      {% snippet "spatial/snippets/dataset_map_big.html", extent=dataset_extent %}
    {% endif %}

    {% block package_resources %}
      {% snippet "package/snippets/resources_list.html", pkg=pkg, resources=pkg.resources %}
    {% endblock %}

    {% block package_additional_info %}
      {% snippet "package/snippets/additional_info.html", pkg_dict=pkg %}
    {% endblock %}

    {% block dataset_feedback %}
      {% snippet "package/snippets/community_feedback.html", pkg=pkg %}
    {% endblock %}

    {% snippet "snippets/social_inline.html" %}
  </div>

  <script>mobileTable();</script>

{% endblock %}

{% block secondary %}
{% endblock %}
