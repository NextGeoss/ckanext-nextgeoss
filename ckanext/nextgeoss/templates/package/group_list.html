{% extends "package/read_base.html" %}
{% import 'macros/form.html' as form %}

{% set pkg = c.pkg_dict %}
{% set org_title = pkg.organization.get('title') or pkg.organization['name'] %}
{% set org_link = h.url_for(controller='organization', action='read', id=pkg.owner_org) %}
{% set org_logo = pkg.organization.get('image_url') or h.url_for_static('/base/images/placeholder-organization.png')%}

{% block subtitle %}
  {{ _('Topics') }} - {{ super() }}
{% endblock %}

{% block pre_primary %}
  <div class="container single-column">
    {% snippet "package/snippets/nav_tabs.html", pkg=pkg %}
    {% block package_description %}
      <div class="dataset-detail-org-logo">
        <div class="image">
          <a href="{{ org_link }}">
            <img src="{{ org_logo }}" height= "100" width="100" alt="{{ org_title }}" />
          </a>
        </div>
      </div>
      {% if pkg.private %}
        <span class="dataset-private label label-inverse pull-right">
          <i class="fa fa-lock"></i>
          {{ _('Private') }}
        </span>
      {% endif %}
      <h1 class="dataset-detail-title">
        {% block page_heading %}
          {{ h.dataset_display_name(pkg) }}
          {% if pkg.state.startswith('draft') %}
            [{{ _('Draft') }}]
          {% endif %}
          {% if pkg.state == 'deleted' %}
            [{{ _('Deleted') }}]
          {% endif %}
        {% endblock %}
      </h1>
      <h5 class="dataset-detail-title">{{ _('Published by ') }} <a href="{{ org_link }}">{{ org_title }}</a></h5>
      <h5 class="dataset-detail-title">{{ _('Licensed under ') }} {% snippet "snippets/license_inline.html", pkg_dict=pkg %}</h5>
    {% endblock %}

    <section class="additional-info">
      <h3><i class="fa fa-info-circle"></i> {{ _('Topics') }}</h3>
      <div class="activity-stream">
        {% if c.group_dropdown %}
          <form method="post" class="form-horizontal">
            <select id="field-add_group" name="group_added" data-module="autocomplete">
              {% for option in c.group_dropdown %}
                <option value="{{ option[0] }}"> {{ option[1] }}</option>
              {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary" title="{{ _('Associate this topic with this dataset') }}">{{ _('Add to topic') }}</button>
          </form>
        {% endif %}

        {% if c.pkg_dict.groups %}
          <form method="post">
            {% snippet 'group/snippets/group_list.html', groups=c.pkg_dict.groups %}
          </form>
        {% else %}
          <p class="empty">{{ _('There are no topics associated with this dataset') }}</p>
        {% endif %}
      </div>
    </section>
    </br>
    </br>
    </br>
    </br>
    </br>
    </br>
  </div>
{% endblock %}

{% block single_column %}
  {# prevents page template from inluding primary and secondary columns #}
{% endblock %}